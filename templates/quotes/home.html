{% extends 'base.html' %}
{% block title %}–°–ª—É—á–∞–π–Ω–∞—è —Ü–∏—Ç–∞—Ç–∞{% endblock %}
{% block content %}
  <h2>–°–ª—É—á–∞–π–Ω–∞—è —Ü–∏—Ç–∞—Ç–∞</h2>
    {% if quote %}
    <article class="quote-card" style="position:relative;">
      {% if request.user.is_authenticated and quote.created_by_id == request.user.id %}
        <form method="post" action="{% url 'quote_delete' quote.id %}" onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å —Ü–∏—Ç–∞—Ç—É?')" style="position:absolute;top:.5rem;right:.7rem;z-index:2;">
          {% csrf_token %}
          <button class="mini-btn delete-quote-btn" title="–£–¥–∞–ª–∏—Ç—å —Ü–∏—Ç–∞—Ç—É" type="submit">√ó</button>
        </form>
      {% endif %}
      <blockquote class="quote-text">{{ quote.text }}</blockquote>
      <div class="quote-meta">
        <span class="source">{{ quote.source.name }} ¬∑ {{ quote.source.get_type_display }}</span>
        <span class="views">üëÅÔ∏è {{ quote.views }} ¬∑ <a href="{% url 'quote_detail' quote.id %}">—Å—Å—ã–ª–∫–∞</a></span>
      </div>
      <div id="like-block" hx-target="#like-block" hx-swap="innerHTML">
        {% include 'quotes/_like_block.html' %}
      </div>
      <section class="comments-card">
        <h3>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h3>
        {% include 'quotes/_comments.html' %}
        {% if request.user.is_authenticated %}
          <form method="post" action="{% url 'add_comment' quote.id %}" hx-post="{% url 'add_comment' quote.id %}" hx-target="#comments" hx-swap="outerHTML" hx-on::after-request="this.reset()">
            {% csrf_token %}
            {{ comment_form.text }}
            <button type="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
          </form>
        {% else %}
          <p class="muted">–ß—Ç–æ–±—ã –∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å, <a href="/login/">–≤–æ–π–¥–∏—Ç–µ</a></p>
        {% endif %}
      </section>
    </article>
    <div class="grid">
      <a role="button" href="/" class="outline">–ù–æ–≤–∞—è —Ü–∏—Ç–∞—Ç–∞</a>
      {% if request.user.is_authenticated and quote.created_by_id == request.user.id %}
        <form method="post" action="{% url 'quote_delete' quote.id %}" onsubmit="return confirm('–£–¥–∞–ª–∏—Ç—å —Ü–∏—Ç–∞—Ç—É?')">{% csrf_token %}
          <button class="secondary">–£–¥–∞–ª–∏—Ç—å —Ü–∏—Ç–∞—Ç—É</button>
        </form>
      {% endif %}
    </div>
  {% else %}
    <p>–ü–æ–∫–∞ –Ω–µ—Ç —Ü–∏—Ç–∞—Ç. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é!</p>
  {% endif %}
{% endblock %}


